import{d as G,r as i,u as J,c as $,m as p,o as K,a as O,w as Q,b as W,e as X,T as Z,l as ee,f as l,g as s,h as n,t as u,i as q,j as te,F as b,k as C,n as A,_ as oe,p as se,q as le,s as ne,v as ae,x as ie}from"./index-DqwmQ0bN.js";const ce={class:"simple-article-list"},re={key:0,class:"loading"},ue={key:1,class:"error"},de={key:2,class:"articles"},ve={key:0,class:"no-articles"},me={key:1,class:"article-grid"},he=["onClick"],fe={class:"article-cover"},pe=["src","alt"],ge=["alt"],_e={class:"article-info"},we={key:0,class:"top-tag"},ye={class:"meta"},ke={class:"fontcolor"},Te={class:"date"},xe={class:"tags"},be=["onClick"],Ce={class:"description"},Pe={class:"zishu"},ze={key:2,class:"pagination"},De=["disabled"],Fe=["onClick"],He=["disabled"],P=6,Se=G({__name:"home",setup(Ne){const g=J(),_=ne(),a=i(Number(g.query.page)||1),w=i([1]),y=i(!1),z=i(null),h=i(0),D=i(0),F=i(0),H=i(!1),v=i(null),m=i(null),B=i(!0),r=$(()=>Math.ceil(p.value.length/P)),E=$(()=>{const e=(a.value-1)*P;return p.value.slice(e,e+P)});function k(e){e>=1&&e<=r.value&&(a.value=e,_.replace({query:{...g.query,page:e}}),T())}function T(){ae(()=>{window.scrollTo({top:0,behavior:"smooth"})})}const x=i(!1),f=i("");async function L(){x.value=!0,f.value="";try{await ee(),p.value.sort((e,o)=>{if(e.top!==void 0&&o.top!==void 0){if(e.top!==o.top)return o.top-e.top}else{if(e.top!==void 0)return-1;if(o.top!==void 0)return 1}return new Date(o.date).getTime()-new Date(e.date).getTime()})}catch(e){f.value=e instanceof Error?e.message:"加载文章失败"}finally{x.value=!1}}function M(){const e=window.scrollY||document.documentElement.scrollTop,o=window.innerHeight,t=document.documentElement.scrollHeight,c=(e+o)/t,d=H.value?.8:.7;return c>=d&&a.value<r.value&&!w.value.includes(a.value+1)}function V(e,o){let t=null;return function(...d){const j=()=>{t&&clearTimeout(t),e(...d)};t&&clearTimeout(t),t=window.setTimeout(j,o)}}function Y(){m.value&&cancelAnimationFrame(m.value),m.value=requestAnimationFrame(()=>{const e=Date.now(),o=window.scrollY||document.documentElement.scrollTop;if(h.value===0||e-h.value>100){const t=e-h.value,c=Math.abs(o-D.value);t>0&&(F.value=c/t);const d=window.innerHeight;H.value=F.value>d*.6/1e3,h.value=e,D.value=o}M()&&S(),v.value&&clearTimeout(v.value),v.value=window.setTimeout(()=>{a.value<r.value&&B.value&&S()},3e3)})}async function S(){if(y.value||a.value>=r.value)return;const e=a.value+1;if(!w.value.includes(e)){y.value=!0;try{w.value.push(e),e>r.value,console.log(`预加载第 ${e} 页完成`)}catch(o){console.error("预加载下一页失败:",o)}finally{y.value=!1}}}const N=V(Y,100);K(()=>{L(),window.addEventListener("scroll",N)}),O(()=>{window.removeEventListener("scroll",N),v.value&&clearTimeout(v.value),z.value&&clearTimeout(z.value),m.value&&cancelAnimationFrame(m.value)});function I(e){return new Date(e).toLocaleDateString("zh-CN")}Q(()=>g.query.page,e=>{const o=Number(e)||1;o!==a.value&&(a.value=o,T())});function R(e){_.push(`/article/${e}`),T()}function U(e){console.log("按标签筛选:",e),_.push(`/tags/${encodeURIComponent(e)}`)}return(e,o)=>(l(),W(Z,{name:"page",mode:"out-in"},{default:X(()=>[s("div",ce,[x.value?(l(),n("div",re," 加载中... ")):f.value?(l(),n("div",ue," 错误: "+u(f.value),1)):(l(),n("div",de,[te(p).length===0?(l(),n("div",ve," 没有找到文章 ")):(l(),n("div",me,[(l(!0),n(b,null,C(E.value,t=>(l(),n("div",{key:t.id,class:"article-card",onClick:c=>R(t.id)},[s("div",fe,[t.cover?(l(),n("img",{key:0,src:t.cover,alt:t.title,class:"cover-image"},null,8,pe)):(l(),n("img",{key:1,src:oe,alt:t.title,class:"cover-image"},null,8,ge))]),s("div",_e,[s("h3",null,[A(u(t.title)+" ",1),t.top!==void 0?(l(),n("span",we,o[2]||(o[2]=[s("svg",{width:"1em",height:"1em",class:"inline text-[var(--primary)] text-2xl mr-2 -translate-y-0.5","data-astro-cid-iyiqi2so":"true","data-icon":"mdi:pin"},[s("symbol",{id:"ai:mdi:pin",viewBox:"0 0 24 24"},[s("path",{fill:"currentColor",d:"M16 12V4h1V2H7v2h1v8l-2 2v2h5.2v6h1.6v-6H18v-2z"})]),s("use",{href:"#ai:mdi:pin"})],-1)]))):q("",!0),o[3]||(o[3]=s("div",{class:"xiaobiao"},"  >",-1))]),s("div",ye,[s("span",ke,[o[4]||(o[4]=s("svg",{width:"1.1em",class:"svg",viewBox:"-43 -17 536 536.00104",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"m385.4375 36.597656h-51.835938v-24.105468c0-6.902344-5.589843-12.492188-12.492187-12.492188-6.894531 0-12.488281 5.589844-12.488281 12.492188v23.980468h-171.125v-23.980468c0-6.902344-5.589844-12.492188-12.488282-12.492188-6.894531 0-12.492187 5.589844-12.492187 12.492188v23.980468h-51.835937c-34.484376.015625-62.4375 27.964844-62.453126 62.453125v341.121094c.015626 34.488281 27.96875 62.441406 62.453126 62.453125h324.757812c34.492188-.011719 62.445312-27.964844 62.453125-62.453125v-340.996094c-.007813-34.484375-27.960937-62.441406-62.453125-62.453125zm-324.757812 24.980469h51.835937v23.984375c0 6.898438 5.597656 12.488281 12.492187 12.488281 6.898438 0 12.488282-5.589843 12.488282-12.488281v-23.984375h171.003906v23.984375c0 6.898438 5.589844 12.488281 12.488281 12.488281 6.898438 0 12.492188-5.589843 12.492188-12.488281v-23.984375h51.957031c20.671875.058594 37.414062 16.800781 37.472656 37.472656v30.726563h-399.703125v-30.726563c.019531-20.6875 16.785157-37.457031 37.472657-37.472656zm324.757812 416.0625h-324.757812c-20.667969-.058594-37.40625-16.796875-37.472657-37.472656v-285.410157h399.703125v285.410157c-.058594 20.675781-16.800781 37.414062-37.472656 37.472656zm0 0",fill:"#000000",style:{fill:"rgb(207, 108, 127)"}}),s("path",{d:"m345.59375 262.800781h-245.066406c-6.898438 0-12.488282 5.597657-12.488282 12.492188 0 6.898437 5.589844 12.492187 12.488282 12.492187h245.066406c6.898438 0 12.492188-5.59375 12.492188-12.492187 0-6.894531-5.59375-12.492188-12.492188-12.492188zm0 0",fill:"#000000",style:{fill:"rgb(207, 108, 127)"}}),s("path",{d:"m242.296875 344.492188h-141.769531c-6.898438 0-12.488282 5.59375-12.488282 12.492187s5.589844 12.492187 12.488282 12.492187h141.769531c6.898437 0 12.492187-5.59375 12.492187-12.492187s-5.59375-12.492187-12.492187-12.492187zm0 0",fill:"#000000",style:{fill:"rgb(207, 108, 127)"}})],-1)),s("span",Te,u(I(t.date)),1)]),s("div",xe,[(l(!0),n(b,null,C(t.tags,c=>(l(),n("span",{key:c,class:"tag",onClick:se(d=>U(c),["stop"])},u(c),9,be))),128))])])]),s("p",Ce,u(t.description),1),o[5]||(o[5]=A()),s("div",Pe,u(t.title.replace(/\s+/g,"").length+t.description.replace(/\s+/g,"").length+t.content.replace(/\s+/g,"").length+" 字"),1)],8,he))),128))])),r.value>1?(l(),n("div",ze,[s("button",{onClick:o[0]||(o[0]=t=>k(a.value-1)),disabled:a.value===1},"上一页",8,De),(l(!0),n(b,null,C(r.value,t=>(l(),n("button",{key:t,class:le({active:t===a.value}),onClick:c=>k(t)},u(t),11,Fe))),128)),s("button",{onClick:o[1]||(o[1]=t=>k(a.value+1)),disabled:a.value===r.value},"下一页",8,He)])):q("",!0)]))])]),_:1}))}}),qe=ie(Se,[["__scopeId","data-v-66edcec5"]]);export{qe as default};
